monetate.c.cr({"data": "  // ////\n  //\n  // JS Action template for MNTTGF 2.0 - 6 febrero 2023\n  // Template de acci\u00f3n javascript para utilizar con las MONETATE GLOBAL FUNCTIONS (MNTTGF) basado en promesas de js\n  //\n  // ////\n  // Nueva funcionalidad:\n  //  - refactorizaci\u00f3n de promesas solo js\n\n  //# sourceURL=t559-cu-turista-premium-monetate.js\n\n\n\n  (function() {\n\n\n    var testName = \"T559 - CU Turista Premium Monetate\";\n    var variantName = \"Variante A\";\n    var t559 = {};\n\n    try {\n    //Carga de configuraci\u00f3n\n    configLoad();\n\n    //Validamos que estan las MNTTGFs\n    wait4MNTTGF()\n    //Si es as\u00ed procedemos con la Variante y si no registramos el problema con MNTTGF\n    .then(processVariant,falloMNTTGFLoad);\n\n    } catch (err)\n    {\n        log2Con(err.toString(), \"error\");\n    }\n\n    //-----------------------------------------\n    // CONFIGURACION DE LA VARIANTE\n    //-----------------------------------------\n\n    function configLoad() {\n\n      t559.audienceTarget = \"iberiacdp_main_436\";\n\n      t559.dataAnalytics = \"heroBanner_2_Home_HeroBanner_DIG_Turista_Premium_0805\";\n      t559.dataAnalyticsCTA = \"heroBanner_cta_2_Home_HeroBanner_DIG_Turista_Premium_0805\";\n\n      //log2Con(\"Cargando configuraci\u00f3n...\",\"debug\");\n      t559.strings = {\n        es: {\n          title: \"M\u00e1s espacio. M\u00e1s comodidad.\",\n          body: \"Bienvenido a la clase Turista Premium\",\n          button: \"Compra ahora\",\n          url: \"ofertas/vuelos/turista-premium/\"\n        },\n        en: {\n          title: \"More space, more comfort.\",\n          body: \"Welcome to Premium Economy Class\",\n          button: \"Buy now\",\n          url: \"es/offer/flights/premium-economy/\"\n        },\n        ca: {\n          title: \"M\u00e9s espai, m\u00e9s comoditat.\",\n          body: \"Benvingut a la classe Turista Premium\",\n          button: \"Compra ara\",\n          url: \"ofertes/vol/turista-premium/\"\n        },\n        fr: {\n          title: \"Plus d'espace, plus de confort.\",\n          body: \"Bienvenue en classe Premium Economy\",\n          button: \"Achetez d\u00e8s \u00e0 pr\u00e9sent\",\n          url: \"offre/vol/premium-economy/\"\n        },\n        de: {\n          title: \"Mehr Platz, mehr Komfort.\",\n          body: \"Willkommen in der Premium Economy\",\n          button: \"Jetzt kaufen\",\n          url: \"/angebote/fluge/premium-economy/\"\n        },\n        it: {\n          title: \"Pi\u00f9 spazio, pi\u00f9 comfort .\",\n          body: \"Benvenuto nella classe Premium Economy\",\n          button: \"Acquista ora\",\n          url: \"offerte/voli/premium-economy/\"\n        },\n        nl: {\n          title: \"Meer ruimte. Meer comfort.\",\n          body: \"Welkom in de Economy Premium Class\",\n          button: \"Nu kopen\",\n          url: \"offerte/voli/premium-economy/\"\n        },\n        ptPT: {\n          title: \"Mais espa\u00e7o. Mais comodidade.\",\n          body: \"Bem-vindo(a) \u00e0 classe Turista Premium\",\n          button: \"Compre j\u00e1\",\n          url: \"voos/economy-premium/\"\n        },\n        ptBR: {\n          title: \"Mais espa\u00e7o. Mais conforto.\",\n          body: \"Seja bem-vindo \u00e0 classe Economy Premium\",\n          button: \"Compre agora\",\n          url: \"voos/economy-premium/\"\n        },\n      };\n\n      // t559.targetIdioma = \"es ca en\";\n      // t559.targetMercado = \"ES GB FR\";\n\n\n      // nivel de criticidad de los mensajes de consola\n      t559.defaultLogLevel = \"debug\";\n      //Para dejar trazas en el DOM\n      // t559.defaultLogLevel = \"info\";\n    }\n\n    //-----------------------------------------\n    // FILTROS Y PROCESADO DE LA VARIANTE\n    //-----------------------------------------\n\n    function processVariant () {\n\n      //Filtros de la Experiencia\n      checkPageReady(isPreConditionsReady)\n      .then(respuesta => checkConditions(checkAudience))\n\n      //Lanzamos la Experiencia\n      .then(respuesta => renderVariant())\n\n      //Control de errores: captura y traza\n      .catch(err => {\n          log2Con(\"Error!!! \" + err.toString(), \"error\");\n        });\n\n    }\n\n    /// functiones de propias de la variante\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////\n\n    function isPreConditionsReady(){\n      return (localStorage.getItem('tealium_va') != null && typeof(JSON.parse(localStorage.getItem('tealium_va')).audiences) != \"undefined\");\n    }\n\n    function checkAudience() {\n      return Object.keys(JSON.parse(localStorage.getItem('tealium_va')).audiences).some( audience => audience == t559.audienceTarget);\n    }\n\n    function renderVariant() {\n\n      // Variant status definition\n      ////////////////////////////\n\n      // If at that point you are defining listener, observers, or other artifacts that doesn't change el original application behaviour,\n      // report now the experience status as \"OK - Waiting\" and include a status change to \"OK - Rendered\" in the listener/observer definition\n\n      //log2Con(\"OK - Waiting\",\"warning\");\n\n      // If you are modifing the original application behaviour, then report as \"OK - Rendered\"\n\n\n\n      // Your code here!!!\n      ///////////////////////////////\n\n      /* SLIDE TURISTA PREMIUM ORIGINAL DE WCS\n      <div class=\"slick-slide slick-current slick-active\" data-slick-index=\"1\" aria-hidden=\"false\" style=\"width: 1116px;\"><div><article class=\"row\" data-analytics=\"heroBanner_2_Home_HeroBanner_DIG_Turista_Premium_0805\" style=\"width: 100%; display: inline-block;\">\n        <div class=\"ibe-search-flights__cover-img-container\"><figure class=\"ibe-search-flights__cover-fig is-loaded\">\n        <picture class=\"lazyLoadCarousel\"><source media=\"(min-width: 1280px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\"><source media=\"(min-width: 1024px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1024.jpg\"><source media=\"(min-width: 768px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_768.jpg\"><source media=\"(min-width: 480px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_480.jpg\"><source media=\"(min-width: 0px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_320_1x.jpg 1x, /wcs/imagenes/ofertas/home/herobanner_tp_230508_320_2x.jpg 2x\"><img fetchpriority=\"high\" itemprop=\"image\" src=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\" data-lazys=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\" alt=\"Turista Premium\" title=\"Turista Premium\" class=\"ibe-search-flights__cover-img css-js\"></picture>\n      </figure></div>\n        <div class=\"col-xs-12 ibe-carousel__full-height\"><div class=\"ibe-home__banner-text center\"><h2 class=\"title title__h2\">M\u00e1s espacio. M\u00e1s comodidad.</h2><p class=\"ibe-search-flights__cover-box__txt\">Bienvenido a la clase Turista Premium </p><a href=\"/il/ofertas/vuelos/turista-premium/\" data-hover=\"Compra ahora\" title=\"Compra ahora\" class=\"ibe-button ibe-button--red ibe-button--small\" data-analytics=\"heroBanner_cta_2_Home_HeroBanner_DIG_Turista_Premium_0805\" tabindex=\"0\"> Compra ahora</a></div></div>\n      </article></div></div>\n      */\n\n      t559.idioma = window.datalayer_general.idioma;\n      t559.mercado = window.datalayer_general.mercado;\n\n      if (t559.idioma==\"pt\") t559.idioma=\"pt\"+t559.mercado;\n\n      var output = `\n        <div id=\"t559-cu-turista-premium-monetate\">\n          <div>\n            <article class=\"row\" data-analytics=\"${t559.dataAnalytics}\" style=\"width: 100%; display: inline-block;\">\n              <div class=\"ibe-search-flights__cover-img-container\">\n                <figure class=\"ibe-search-flights__cover-fig is-loaded\">\n                  <picture class=\"lazyLoadCarousel\"><source media=\"(min-width: 1280px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\">\n                    <source media=\"(min-width: 1024px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1024.jpg\">\n                    <source media=\"(min-width: 768px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_768.jpg\">\n                    <source media=\"(min-width: 480px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_480.jpg\">\n                    <source media=\"(min-width: 0px)\" srcset=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_320_1x.jpg 1x, /wcs/imagenes/ofertas/home/herobanner_tp_230508_320_2x.jpg 2x\"><img fetchpriority=\"high\" itemprop=\"image\" src=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\" data-lazys=\"/wcs/imagenes/ofertas/home/herobanner_tp_230508_1280.jpg\" alt=\"Turista Premium\" title=\"Turista Premium\" class=\"ibe-search-flights__cover-img css-js\">\n                  </picture>\n                </figure>\n              </div>\n              <div class=\"col-xs-12 ibe-carousel__full-height\">\n                <div class=\"ibe-home__banner-text center\">\n                  <h2 class=\"title title__h2\">${t559.strings[t559.idioma].title}</h2>\n                  <p class=\"ibe-search-flights__cover-box__txt\">${t559.strings[t559.idioma].body}</p>\n                  <a href=\"/${t559.mercado}/${t559.strings[t559.idioma].url}\" data-hover=\"Compra ahora\" title=\"Compra ahora\" class=\"ibe-button ibe-button--red ibe-button--small\" data-analytics=\"${t559.dataAnalyticsCTA}\" tabindex=\"0\">${t559.strings[t559.idioma].button}</a>\n                </div>\n              </div>\n            </article>\n          </div>\n        </div>\n        `;\n\n      if (!document.querySelector(\"#t559-cu-turista-premium-monetate\")) {\n        log2Con(\"No existe el banner, procedemos a insertarlo en el carrusel.\",\"info\");\n\n        // https://kenwheeler.github.io/slick/\n        if( $('.slick-full-window.slick-slider').slick('getSlick').slideCount == 1)\n          $('.slick-full-window.slick-slider').slick('slickAdd', output, 0); // index or addBefore\n        else\n          $('.slick-full-window.slick-slider').slick('slickAdd', output, 1); // index or addBefore\n\n        log2Con(\"OK - Rendered\",\"warning\");\n        log2GTM();\n\n      } else\n      {\n         log2Con(\"Ya existe el banner en el carrusel.\",\"warning\");\n      }\n\n      ///////////////////////////////\n\n      log2Con(\"Fin de la variante\",\"info\");\n    }\n\n    /// functiones core del template\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////\n\n\n\n    function wait4MNTTGF() {\n      return new Promise(function(resolve,reject) {\n\n        console.debug(new Date().toLocaleString(\"es-ES\",{timeZoneName:\"short\"}) + \" - [\" + testName + \"|\" + variantName + \"] - waiting 4 MNTTGF to load...\");\n\n        //Evaluamos si las MNTTGF se han cargado cada 100 milisegundos y si es as\u00ed resolvemos la promesa\n        setTimeout(() => {\n          const intervalMNTTGF = setInterval(function() {\n            if (window.mnttGF) {\n              log2Con(\"MNTTGF running!! :)\",\"info\");\n              clearInterval(intervalMNTTGF);\n              clearTimeout(timeoutMGTTGF);\n              resolve();\n            } else if (window.mnttGF==\"locked\") {\n              log2Con(\"ATTENTION!!!! MNTTGF LOCKED!!!!!!!!!!!!!!!!!!!!!!!!! :(\",\"warning\");\n              clearInterval(intervalMNTTGF);\n              clearTimeout(timeoutMGTTGF);\n              resolve();\n            } else if (window.mnttGF==\"loading\") {\n              log2Con(\"loading MNTTGF... :|\",\"info\");\n            }\n          },100);\n\n          //Si tras 10 segundos no se han cargado las MNTTGF rechazamos la promesa\n          const timeoutMGTTGF = setTimeout(() => {\n            clearInterval(intervalMNTTGF);\n            reject();\n          },10000);\n        },0);\n\n\n      });\n    }\n\n    function falloMNTTGFLoad() {\n      timestamp = new Date().toLocaleString(\"es-ES\",{timeZoneName:\"short\"});\n      texto = \"MNTTGF TIMEOUT!!!: No se ha cargado la experiencia MONETATE GLOBAL FUNCTIONS :(\";\n      aviso = timestamp + \" [\" + testName + \"|\" + variantName + \"]:--> \" + texto;\n\n      console.error(aviso);\n\n      avisoHTML='<div class=\"mnttgf_error\">' + timestamp + ': ' + texto + '</div>';\n\n      // lo metemos en el DOM para que lo registre QM\n\n      if (document.getElementById(\"MNTT_LOGS\")==null) {\n        output = '<div data-nosnippet id=\"MNTT_LOGS\" class=\"mnttgf_logs\" style=\"display: none;\"></div>';\n        document.querySelector(\"body\").insertAdjacentHTML(\"beforeend\", output);\n      }\n\n      idText = (testName + '_' + variantName).trim();\n\n      if (document.getElementById(idText) == null) {\n        output = '<div id=\"' + idText + '\" class=\"mnttgf_logs\" style=\"display: none;\">Monetate log: [' + testName + '][' + variantName + '] </div>';\n        document.getElementById(\"MNTT_LOGS\").insertAdjacentHTML(\"beforeend\", output);\n      }\n\n      document.getElementById(idText).insertAdjacentHTML(\"beforeend\",avisoHTML);\n    }\n\n\n\n    /// funciones proxy para MNTTGF\n    /////////////////////////////////////////////\n\n    function checkPageReady(pageCondition = function() {return true;}){\n      return mnttCheckPageReady(testName,variantName,pageCondition);\n    }\n\n    function checkConditions(funcionCondicion,conditionDescription = \"\") {\n      return mnttCheckConditions(testName,variantName,funcionCondicion,conditionDescription);\n    }\n\n    function checkTarget(target,currentValue,targetDescription = \"\") {\n      return mnttCheckTarget(testName,variantName,target,currentValue,targetDescription);\n    }\n\n    function log2Con(texto,criticidad = \"info\") {\n        mnttLog2Con(testName,variantName,texto,criticidad);\n    }\n\n    function obj2Con(objeto) {\n        mnttObj2Con(testName,variantName,objeto);\n    }\n\n    function log2GTM(test = testName, action = variantName, value = \"\") {\n        mnttLog2GTM(test,action,value);\n    }\n\n    function sendEventQM(eventNum,eventValue = \"\",eventDesc=\"\")\n    {\n        mnttSendEventQM(testName,variantName,eventNum,eventValue,eventDesc);\n    }\n\n    /////////////////////////////////////////\n\n  })();\n\n", "ref": "1123/5272942.js"});